<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyChat</title>
<style>
  body { margin:0; padding:0; height:100vh; background:black; font-family: Arial,sans-serif; overflow:hidden; }
  .star { position:absolute; width:2px; height:2px; background:white; border-radius:50%; animation:twinkle 2s infinite; }
  @keyframes twinkle { 0%,100%{opacity:1;}50%{opacity:0.3;} }
  #chatWindow { position:absolute; bottom:20px; right:20px; width:300px; height:400px; background:rgba(0,0,50,0.85); border-radius:10px; display:flex; flex-direction:column; overflow:hidden; color:white; padding:10px; }
  #messages { flex:1; overflow-y:auto; margin-bottom:10px; }
  #messages div { margin-bottom:5px; }
  #inputForm { display:flex; }
  #inputForm input { flex:1; padding:5px; border-radius:5px; border:none; margin-right:5px; }
  #inputForm button { padding:5px 10px; border-radius:5px; border:none; background:#0d6efd; color:white; cursor:pointer; }
</style>
</head>
<body>
<script>
  const stars = 150;
  for(let i=0;i<stars;i++){
    const star=document.createElement('div');
    star.className='star';
    star.style.top=Math.random()*100+'%';
    star.style.left=Math.random()*100+'%';
    star.style.width=star.style.height=Math.random()*2+1+'px';
    star.style.animationDuration=(Math.random()*3+2)+'s';
    document.body.appendChild(star);
  }
</script>

<div id="chatWindow">
  <div id="messages"></div>
  <form id="inputForm">
    <input id="msgInput" autocomplete="off" placeholder="Type a message..." />
    <button>Send</button>
  </form>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket=io();
const form=document.getElementById('inputForm');
const input=document.getElementById('msgInput');
const messages=document.getElementById('messages');

socket.on('chat history', msgs=>{
  msgs.forEach(m=>{
    const div=document.createElement('div');
    div.textContent=m.text;
    messages.appendChild(div);
  });
  messages.scrollTop=messages.scrollHeight;
});

form.addEventListener('submit',e=>{
  e.preventDefault();
  if(!input.value) return;
  socket.emit('chat message', input.value);
  input.value='';
});

socket.on('chat message',m=>{
  const div=document.createElement('div');
  div.textContent=m.text;
  messages.appendChild(div);
  messages.scrollTop=messages.scrollHeight;
});
</script>
</body>
</html>
